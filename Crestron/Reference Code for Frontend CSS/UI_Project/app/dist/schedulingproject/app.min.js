!function(){"use strict";angular.module("helium",["ngRoute","ngAnimate","ui.bootstrap","pascalprecht.translate","tmh.dynamicLocale","ngSanitize"])}(),function(){"use strict";angular.module("helium").component("hlmTimeGroupRoller",{templateUrl:"views/components/time-group-roller.html",controller:"TimeRollerGroupCtrl",transclude:!0,bindings:{formatTime:"<",hoursFormat:"<",minutesFormat:"<",ampmFormat:"<",langArabic:"<",startDate:"<",endDate:"<",step:"<",label:"=",data:"<",value:"=",hoursRange:"<",minutesRange:"<",ampmRange:"<",isSelected:"<"}})}(),function(){"use strict";function a(){function a(a,b){return new Date(a.getTime()+6e4*b)}function b(b,c){var d=function(){for(var d=[],e=new Date(b);e<c;)e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),d.push(e),e=a(e,60);return d.length&&c.getHours()===d[d.length-1].getHours()||d.push(c),d}();return{options:d,value:d[0]}}function c(b,c){var d=function(){var d=[],e=b;for(0===c.getHours()?(c=new Date(c),c.setMinutes(0)):b.getHours()<c.getHours()&&(c=new Date(b),c.setMinutes(59));e<c;)d.push(e),e=a(e,1);return d.length&&c.getMinutes()===d[d.length-1].getMinutes()||d.push(c),d}();return{options:d,value:d[0]}}function d(a,b){var c=a.getHours(),d=b.getDay()!==a.getDay()?24:a.getHours();return c<12&&d<12?{options:[a],value:a}:c<12&&d>=12?{options:[a,b],value:a}:c>=12&&d>=12?d<24?{options:[b],value:b}:{options:[a],value:a}:void 0}function e(a,c){i.hoursRange=b(a,c)}function f(a,b){i.minutesRange=c(a,b)}function g(a,b){i.ampmFormat&&(i.ampmRange=d(a,b))}function h(){i.startDate&&i.endDate&&(i.ampmFormat=i.ampmFormat||!1,e(i.startDate,i.endDate),f(i.startDate,i.endDate),g(i.startDate,i.endDate))}var i=this,j={value:null,hour:null};i.$onInit=function(){i.data&&i.data.options||h()},i.$onChanges=function(a){i.data&&i.data.options||(a.startDate||a.endDate)&&h()},i.$doCheck=function(){if(i.data&&i.data.options)!i.data.value||j.value&&j.value.getTime()===i.data.value.getTime()||(i.value=j.value=i.data.value);else if(i.hoursRange&&i.minutesRange){var a=new Date,b=a.getDate(),c=new Date(i.hoursRange.value);a.setDate(c.getDate()),a.setHours(c.getHours()),a.setMinutes(b!==c.getDate()?0:new Date(i.minutesRange.value).getMinutes()),a.setSeconds(0),a.setMilliseconds(0),!a.getTime()||j.value&&j.value.getTime()===a.getTime()||(i.value=j.value=a),!c.getTime()||j.hour&&c.getTime()===j.hour.getTime()||(j.hour=c,i.startDate&&(f(new Date(Math.max(c.getTime(),i.startDate.getTime())),i.endDate),g(new Date(Math.max(c.getTime(),i.startDate.getTime())),i.endDate))),!c.getTime()||j.hour&&c.getTime()===j.hour.getTime()||(j.hour=c,i.startDate&&(f(new Date(Math.max(c.getTime(),i.startDate.getTime())),i.endDate),g(new Date(Math.max(c.getTime(),i.startDate.getTime())),i.endDate)))}}}angular.module("helium").controller("TimeRollerGroupCtrl",a),a.$inject=[]}(),function(){"use strict";angular.module("helium").component("hlmTimeline",{templateUrl:function(){return"views/components/timeline.html"},controller:"TimelineCtrl",transclude:!0,bindings:{timelinePlacement:"@",timelineViewport:"@",timelineBlockSize:"@",timelineBlockHorizontalSize:"@",timelineBlockVerticalSize:"@",timelineNrHours:"@",timelineStartHour:"@",timelineMinutesScale:"@",timelineEvents:"<",timelineDisableInteraction:"<",timelinePauseAutoScroll:"<",timelineOpenNewEvent:"&",timelineOpenEvent:"&",timelineDisableClick:"<",timelineDisableDetailsClick:"<",timelineDisableAutoScroll:"<",timelineDialog:"@",timelineLabelTop:"@",timelineLabelRight:"@",timelineArabic:"@",timelineDateHourMarker:"<",timelineDateHourFormat:"<",timelineDateTimeFormat:"<",timelineIntervalAutoScroll:"@",timelineEvent:"<",timelineEventTitle:"<",timelineLabelNoon:"<"}})}(),function(){"use strict";function a(a,b,c,d){function e(){J&&(J.removeEventListener("touchstart",g,{passive:!0}),J.removeEventListener("touchend",h,{passive:!1})),N=!1,clearTimeout(G)}function f(){J&&!1===N&&(N=!0,J.addEventListener("touchstart",g,{passive:!0}),J.addEventListener("touchend",h,{passive:!1}))}function g(a){if(!(a.touches.length>1))return O=!0,M.stopScrolling=!0,K.disableAutoScroll||K.pauseAutoScroll?void 0:void j()}function h(a){if(!(a.touches.length>0))return O=!1,M.stopScrolling=!1,K.disableAutoScroll||K.pauseAutoScroll?void 0:void i()}function i(){if(!(K.disableAutoScroll||K.pauseAutoScroll||O)){var a=K.intervalAutoScroll;clearTimeout(G),G=setTimeout(function(){if(O)return void i();null!==J&&void 0!==J?k(J):w()},a)}}function j(){clearTimeout(G)}function k(a){var b=m();"vertical"===K.placement||"portrait"===K.placement?d.scroll(a,b,2e3,"vertical"):d.scroll(a,b,2e3)}function l(a){var b,c;return a&&!isNaN(a)&&(b=Math.floor(a/K.blockSize)+K.startHour,c=Math.floor(a%K.blockSize*60/K.blockSize)),{hours:b,minutes:c}}function m(){var a,b,c=l(K.currentTimePosition);return c.minutes=0,a=n(c),isNaN(a)?b=0:(K.isArabic&&(a=K.timelineSize-a-K.timelineViewport),b=isNaN(a)?0:a),b}function n(a){var b;return!a||isNaN(a.hours)||isNaN(a.minutes)||(b=K.blockSize*(a.hours-K.startHour),b+=K.blockSize/60*a.minutes),b}function o(a){for(var b=a,c=0,d=0;b&&!isNaN(b.offsetLeft)&&!isNaN(b.offsetTop);)c+=b.offsetLeft-b.scrollLeft,d+=b.offsetTop-b.scrollTop,b=b.offsetParent;return{left:c,top:d}}function p(){var a=L.lastHour-K.startHour;a<K.nrHours&&(K.nrHours=a)}function q(a,b){var c=new Date;return a<c&&c<=b}function r(a){return a<new Date}function s(){if(K.timelineEvents=K.timelineEvents||[],angular.forEach(K.timelineEvents,function(a){var b=u(a);a.finished=!!r(a.dtEnd),a.active=!!q(a.dtStart,a.dtEnd),a.startPosition=b.startPosition,a.size=b.size}),K.timelineEvent){var a=K.timelineEvent,b=u(a);a.startPosition=b.startPosition,a.size=b.size}}function t(a,b){var c,d,e=Math.abs(a-b)/1e3;return c=Math.floor(e/3600),e-=3600*c,d=Math.floor(e/60)%60,e-=60*d,{hours:c,minutes:d}}function u(a){var b=a.dtStart,c=a.dtEnd,d={hours:b.getHours(),minutes:b.getMinutes()},e=t(c,b);return{startPosition:n(d),size:n(e)}}function v(){I=setTimeout(function(){w(),H=c(function(){w()},L.intervalScrollToNow)},60020-(new Date).getTime()%6e4)}function w(){var a=new Date,b={hours:a.getHours(),minutes:a.getMinutes()};K.now=a,K.currentTimePosition=n(b),!J||K.disableAutoScroll||K.pauseAutoScroll||O||k(J)}function x(a,b){var c,d,e,f=[],g=b,h=a+b,i=h>L.lastHour?L.lastHour:h;for(g;g<i;g++){c=new Date,c.setHours(g),c.setMinutes(0),c.setSeconds(0),d=new Date,d.setHours(g),d.setMinutes(0),d.setSeconds(0),e=new Date,e.setHours(g),e.setMinutes(30),e.setSeconds(0);var j={date:c,subHours:[{start:d},{start:e}]};f.push(j)}return f}function y(){var a,b;K.timelineEvent?(b=u(K.timelineEvent),a=b.startPosition):a=m(),K.jumpScrollToPosition=a}function z(){"vertical"===K.placement||"portrait"===K.placement?K.labelTop=(!K.timelineLabelRight||"true"!==K.timelineLabelRight)&&L.labelTop:K.labelTop=(!K.timelineLabelTop||"false"!==K.timelineLabelTop)&&L.labelTop}function A(a){a&&("vertical"===K.placement||"portrait"===K.placement?a.style.setProperty("height",K.timelineViewport+"px"):a.style.setProperty("width",K.timelineViewport+"px"))}function B(){"portrait"===K.placement?K.timelineViewport=.375*window.innerHeight:"vertical"===K.placement?K.timelineViewport=K.timelineViewport?parseInt(K.timelineViewport):window.innerHeight:K.timelineViewport=K.timelineViewport?parseInt(K.timelineViewport):window.innerWidth}function C(){var a=K.timelineEvents;angular.forEach(K.timelineEvents,function(a){a.selected=!1}),K.timelineEvents=[],angular.extend(K.timelineEvents,a)}function D(){K.disableClick=!0,K.disableDetailsClick=!0,K.disableAutoScroll=!0,K.centerEvent=!0,C(),c.cancel(H)}function E(a){return"string"==typeof a||a instanceof String}function F(){setTimeout(function(){e();var a=document.getElementsByClassName("timeline--"+K.placement);a.length&&!N&&(J=a[0],B(),A(J),f())},0)}var G,H,I,J,K=this,L={blockHorizontalSize:322,blockVerticalSize:113,dialogWidthPercent:.43,dialogBlockPercent:3.5,nrHours:24,lastHour:24,startHour:0,scale:2,placement:"horizontal",disableClick:!1,disableDetailsClick:!1,disableAutoScroll:!1,pauseAutoScroll:!1,labelTop:!0,labelRight:!0,verticalVisibleBlocks:6,horizontalVisibleBlocks:10,dateHourFormat:"h",dateHourMarker:"a",dateTimeFormat:"h:mm a",intervalScrollToNow:6e4,intervalScrollToCurrentHour:36e5,intervalAutoScroll:1e4},M={stopScrolling:!1},N=!1,O=!1;d.setConfig(M),K.getStyle=function(a){var b=u(a);return"vertical"===K.placement||"portrait"===K.placement?{height:b.size+"px",top:b.startPosition+"px"}:{width:b.size+"px",left:b.startPosition+"px"}},K.isEventActive=function(a){var b=!1;return K.timelineDisableInteraction||q(a.dtStart,a.dtEnd)&&(b=!0),b},K.isEventFinished=function(a){var b=!1;return K.timelineDisableInteraction||r(a.dtEnd)&&(b=!0),b},K.isEventSelected=function(a){var b=!1;return K.timelineDisableInteraction&&a.selected&&(b=!0),b},K.isRoomReserved=function(){var a=!1;return angular.forEach(K.timelineEvents,function(b){q(b.dtStart,b.dtEnd)&&(a=!0)}),a},K.isSubBlockFinished=function(b,c){var d=K.currentTimePosition,e=l(d),f=K.scale,g=60/f,h={hours:b.subHours[c].start.getHours(),minutes:b.subHours[c].start.getMinutes()};if(e.hours>h.hours)return!0;if(e.hours===h.hours&&e.minutes-h.minutes>g)return!0;if(a.Helium.settings.reservation.reserveNowEvenEndTime&&void 0!==a.Helium.values.mainRoom.events){var i=0;for(i=0;i<a.Helium.values.mainRoom.events.length;i++){var j=a.Helium.values.mainRoom.events[i];if(j.dtStart.getHours()===h.hours&&j.dtStart.getMinutes()>h.minutes)return 0!==h.minutes||j.dtStart.getMinutes()<30}}return!1},K.onClickBlock=function(a){if(!K.disableClick){var b,c,d=a.pageX,e=a.pageY,f=a.currentTarget.parentElement,g=f.parentElement,h=o(f),i=new Date,j=new Date;if(a.target.className.indexOf("timeline__content__block__subBlocks__subBlock")>=0)if(b="vertical"===K.placement||"portrait"===K.placement?e-h.top+g.scrollTop:d-h.left+g.scrollLeft,K.isArabic&&(b=isNaN(b)?0:K.timelineSize-b),c=l(b),j.setHours(c.hours,c.minutes,0,0),i<=j)K.timelineOpenNewEvent()(j);else{var k=o(a.target),m=K.subBlockSize+k.left,n=K.subBlockSize+k.top,p=K.currentTimePosition;"vertical"===K.placement||"portrait"===K.placement?p>k.top&&p<n&&K.timelineOpenNewEvent()(i):p>k.left&&p<m&&K.timelineOpenNewEvent()(i)}}},K.onClickEventBlock=function(a){K.disableDetailsClick||(a.selected=!0,K.timelineOpenEvent()(a))},K.$onInit=function(){var a;K.intervalAutoScroll=K.timelineIntervalAutoScroll?parseInt(K.timelineIntervalAutoScroll):L.intervalAutoScroll,K.timelineDateHourFormat=E(K.timelineDateHourFormat)?K.timelineDateHourFormat:L.dateHourFormat,K.timelineDateHourMarker=E(K.timelineDateHourMarker)?K.timelineDateHourMarker:L.dateHourMarker,K.timelineDateTimeFormat=E(K.timelineDateTimeFormat)?K.timelineDateTimeFormat:L.dateTimeFormat,K.placement=K.timelinePlacement||L.placement,K.scale=K.timelineMinutesScale?parseInt(K.timelineMinutesScale)+1:L.scale,K.timelineArabic="true"===K.timelineArabic||"false"!==K.timelineArabic&&!0===K.timelineArabic,K.showNoon=!K.timelineArabic,K.isArabic=!(!K.timelineArabic||"horizontal"!==K.placement),B(),"vertical"===K.placement||"portrait"===K.placement?K.blockSize=K.timelineBlockVerticalSize?parseInt(K.timelineBlockVerticalSize):L.blockVerticalSize:K.blockSize=K.timelineBlockHorizontalSize?parseInt(K.timelineBlockHorizontalSize):L.blockHorizontalSize,K.subBlockSize=Math.round(K.blockSize/K.scale),a=K.scale,K.blockSize=K.blockSize+a/2,K.startHour=parseInt(K.timelineStartHour)||L.startHour,K.nrHours=parseInt(K.timelineNrHours)||L.nrHours,p(),K.timelineSize=K.blockSize*K.nrHours,K.arrayHours=x(K.nrHours,K.startHour),s(),w(),v(),K.disableClick=void 0!==K.timelineDisableClick&&!0===K.timelineDisableClick||L.disableClick,K.disableAutoScroll=void 0!==K.timelineDisableAutoScroll&&!0===K.timelineDisableAutoScroll||L.disableAutoScroll,K.pauseAutoScroll=void 0!==K.timelinePauseAutoScroll&&!0===K.timelinePauseAutoScroll,K.timelineEventTitle=void 0!==K.timelineEventTitle&&!0===K.timelineEventTitle,K.disableDetailsClick=void 0!==K.timelineDisableDetailsClick&&!0===K.timelineDisableDetailsClick||L.disableDetailsClick,K.timelineDisableInteraction&&D(),y(),z()},K.$onChanges=function(a){angular.isDefined(a.timelinePlacement)&&(K.placement=a.timelinePlacement.currentValue,F()),angular.isDefined(a.timelineColorTheme)&&F(),angular.isDefined(a.timelineDisableClick)&&(K.disableClick=a.timelineDisableClick.currentValue),angular.isDefined(a.timelineDisableDetailsClick)&&(K.disableDetailsClick=a.timelineDisableDetailsClick.currentValue),a.timelinePauseAutoScroll&&(K.pauseAutoScroll=a.timelinePauseAutoScroll.currentValue,K.pauseAutoScroll?j():i()),a.timelineDisableAutoScroll&&(K.disableAutoScroll=a.timelineDisableAutoScroll.currentValue,K.disableAutoScroll?e():f())},K.$postLink=function(){F()},K.$onDestroy=function(){e(),c.cancel(H),clearTimeout(G),clearTimeout(I),J=null}}angular.module("helium").controller("TimelineCtrl",a),a.$inject=["$rootScope","$scope","$interval","SmoothScrollService"]}(),function(){"use strict";function a(){function a(a,c,d){var e;return(e=b((d-a)/(c-a),0,1))*e*e*(e*(6*e-15)+10)}function b(a,b,c){return a<b&&(a=b),a>c&&(a=c),a}var c=this;this.setConfig=function(a){c.config=a},this.scroll=function(b,d,e,f){var g,h,i="vertical"===f?"scrollTop":"scrollLeft",j=b[i],k=Date.now();c.config.stopScrolling=!1;var l=parseInt(d),m=parseInt(e);return 0===m?(b[i]=l,Promise.resolve()):(g=k+m,h=l-j,0===Math.round(h)?Promise.resolve():new Promise(function(d){var e,f=function(){var l,m,n,o=Date.now();return!0===c.config.stopScrolling?void d():(l=a(k,g,o),m=parseFloat(j+h*l).toFixed(2),n=b[i],o>=g||n===e&&n!==m?void d():(b[i]=m,e=m,void window.requestAnimationFrame(f)))};window.requestAnimationFrame(f)}))}}angular.module("helium").service("SmoothScrollService",a),a.$inject=[]}(),function(){"use strict";function a(a){return{restrict:"A",scope:{jumpTo:"=",placement:"=",event:"<",timelineSize:"<",timelineViewport:"<",isArabic:"<",timelineDialog:"<"},replace:!1,link:function(b,c){var d=b.$watch("jumpTo",function(e){var f,g=c.parent().parent(),h="vertical"===b.placement||"portrait"===b.placement?g.height():g.width(),i=e;"portrait"===b.placement&&(h=.375*g.height()),b.event&&(b.isArabic&&(f=h-b.event.size,i=b.timelineSize-b.event.startPosition-b.event.size-f),h&&setTimeout(function(){if(c[0].style.width=h+"px","vertical"===b.placement||"portrait"===b.placement)c[0].scrollTop=i;else if(b.timelineDialog&&a.isRtl){var d=.016,e=window.devicePixelRatio;e>1?d=b.timelineViewport>500?.018:.028:e<1&&(d=.014),c[0].scrollLeft=i-b.timelineViewport*d}else c[0].scrollLeft=i},500)),"vertical"===b.placement||"portrait"===b.placement?c[0].scrollTop=i:c[0].scrollLeft=i,d()})}}}angular.module("helium").directive("hlmScrollInit",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(a){var b=null,c="views/partials/room.html";a.when("/page/:page",{resolve:{checkTemplate:["$rootScope","$route","templateService","$q",function(a,d,e,f){var g=f.defer();return b=e.getPageTemplateUrl(d.current.params.page),a.Helium.state.offlineLimit?b===c?g.resolve():(g.reject(),b=c):g.resolve(),g.promise}]},templateUrl:function(){return b||c}}).otherwise({redirectTo:c})}angular.module("helium").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a){a.preferredLanguage("en"),a.useSanitizeValueStrategy("escape")}function b(a){a.defaultLocale("en"),a.localeLocationPattern("bower_components/angular-i18n/angular-locale_{{locale}}.js")}angular.module("helium").config(a).config(b),a.$inject=["$translateProvider"],b.$inject=["tmhDynamicLocaleProvider"]}(),function(){"use strict";angular.module("helium").constant("AppConfig",{delayTime:1e4,hourInMin:60,arabicLanguage:!1,template:{arabicTemplateSuffix:"_arabic",modalFolderPath:"views/modals/",pageFolderPath:"views/partials/"},screenSaverDelay:3e5,errorMsgCloseDelay:1e4,successMsgCloseDelay:1e4,timeoutLoadingMask:6e4,timeoutPendingRoom:6e4})}(),function(){"use strict";function a(a,b,c,d,e,f){var g=!1,h={state:!0,message:b.Helium.labels.details.loadingMessage};a.working=!1,a.data={},angular.extend(b.Helium.state.loading,h),b.$watch("Helium.state.isOnline",function(b){g&&(a.data.helpProviderData.isOnline=b)}),b.$watch("Helium.state.refreshingProvider",function(b){a.working=b}),e.sendAbout(function(e,f){b.$evalAsync(function(){e?(a.data=f.data,g=!0,d.get("appInfo.json").then(function(c){b.Helium.state.loading.state=!1,a.data.helpVersionData=a.data.helpVersionData||{},a.data.helpVersionData.web=c.data.version},function(){console.log("Invalid appInfo.json file"),b.Helium.state.loading.state=!1})):(console.log("NO data received"),c.close(),b.Helium.state.loading.state=!1)})}),a.cancel=function(){c.dismiss("cancel")},a.refresh=function(){a.working||(a.working=!0,f.setRefreshProviderTimeout(),e.sendRefreshSchedule(function(){}))}}angular.module("helium").controller("AboutCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance","$http","CommunicationService","AppStateService"]}(),function(){"use strict";function a(a,b,c){a.event=c,a.cancel=function(){b.dismiss("cancel")}}angular.module("helium").controller("DetailsCtrl",a),a.$inject=["$scope","$uibModalInstance","event"]}(),function(){"use strict";function a(a,b,c,d,e){var f=!1;a.loading={state:!1,message:b.Helium.labels.endEvent.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},a.event=b.Helium.values.mainRoom.currentEvent,b.$on("currentEvent",c.close),a.end=function(){if(!f){var g=b.Helium.values.mainRoom.currentEvent;b.$evalAsync(function(){f=!0,a.loading.state=!0,angular.extend(b.Helium.state.loading,a.loading)});var h=setTimeout(function(){b.$evalAsync(function(){a.loading.responseReceived||(a.loading.showErrorMessageTimeout=!0,a.loading.state=b.Helium.state.loading.state=!1,c.close(),b.Helium.methods.openMsgError(!0))})},e.timeoutLoadingMask);d.sendEndEvent(g.id,g.instanceId,function(d){a.loading.showErrorMessageTimeout||(a.loading.responseReceived=!0,clearTimeout(h),b.$evalAsync(function(){a.loading.state=b.Helium.state.loading.state=!1,f=!1,d||b.Helium.methods.openMsgError(),c.close()}))})}},a.cancel=function(){c.dismiss("cancel")}}angular.module("helium").controller("EndEventCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance","CommunicationService","AppConfig"]}(),function(){"use strict";function a(a,b,c,d){var e=setTimeout(function(){b.close()},c.errorMsgCloseDelay);a.addEvent=d,a.cancel=function(){b.dismiss("cancel")},a.$on("$destroy",function(){clearTimeout(e)})}angular.module("helium").controller("ErrorMsgCtrl",a),a.$inject=["$scope","$uibModalInstance","AppConfig","addEvent"]}(),function(){"use strict";function a(a,b,c,d,e,f){var g=a.Helium.values.mainRoom,h=g.currentEvent,i=g.nextEvent,j=!1;b.$on("currentEvent",c.close),a.loading={state:!1,message:b.Helium.labels.extendEvent.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},a.event=b.Helium.values.mainRoom.currentEvent,a.duration={},a.duration.options=d.generateAvailableExtendTime(h.dtEnd,i&&i.dtStart?i.dtStart:null,15),a.duration.value=a.duration.options[0],a.extend=function(){if(!j){b.$evalAsync(function(){j=!0,a.loading.state=!0,angular.extend(b.Helium.state.loading,a.loading)});var d=setTimeout(function(){b.$evalAsync(function(){a.loading.responseReceived||(a.loading.showErrorMessageTimeout=!0,a.loading.state=b.Helium.state.loading.state=!1,c.close(),b.Helium.methods.openMsgError(!0))})},f.timeoutLoadingMask);e.sendExtendEvent(h.id,h.instanceId,a.duration.value,function(e){a.loading.showErrorMessageTimeout||(a.loading.responseReceived=!0,clearTimeout(d),b.$evalAsync(function(){a.loading.state=b.Helium.state.loading.state=!1,j=!1,e||b.Helium.methods.openMsgError(),c.close()}))})}},a.cancel=function(){c.dismiss("cancel")}}angular.module("helium").controller("ExtendEventCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance","TimelineService","CommunicationService","AppConfig"]}(),function(){"use strict";function a(a,b,c,d){var e=b.Helium.values.roomId;e=null===e||void 0===e?"":e,a.model={rooms:[],isLoading:!0},d.sendRoomSearch(e,function(c,d){a.$evalAsync(function(){if(a.model.isLoading=!1,c){var e,f=a.model;if(f.rooms=d.data&&d.data.rooms?d.data.rooms:[],f.noRooms=!(d.data&&d.data.rooms&&d.data.rooms.length),f.rooms.length>0)for(var g=0;g<f.rooms.length;g++)f.rooms[g].id===b.pendingReservation.prevRoomID&&f.rooms.splice(g,1);angular.forEach(a.model.rooms,function(a){e=!!a.freeUntil&&a.freeUntil,a.availableForDuration=b.Helium.state.getRemainingTimeString({dtEnd:e})})}})}),a.openReservation=function(a){b.Helium.settings.reservation.reservationEnable&&b.Helium.methods.openReservation(!1,a)},a.cancel=function(){c.dismiss("cancel")}}angular.module("helium").controller("FindRoomCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance","CommunicationService"]}(),function(){"use strict";function a(a,b,c){function d(){var b,c=g.length;if(c)for(b=0;b<c;b++)a.pinCircles.push({set:!1})}function e(){a.disablePinEntry=!0,$(".pin__container__header__password").addClass("shake"),setTimeout(function(){f(),$(".pin__container__header__password").removeClass("shake")},400)}function f(){a.$evalAsync(function(){a.pin="",a.pinCircles.splice(0,a.pinCircles.length),d(),a.disablePinEntry=!1})}var g=b.Helium.settings.accessControl.pin?b.Helium.settings.accessControl.pin.toString():[];a.pin="",a.pinCircles=[],a.disablePinEntry=!1,d(),a.deteleCircle=function(){a.$evalAsync(function(){a.pin=a.pin.substr(0,a.pin.length-1),a.pinCircles[a.pin.length].set=!1})},a.$watch("pin",function(b){b&&b.length<=g.length&&(a.pinCircles[b.length-1].set=!0,b===g?setTimeout(function(){c.close(!0)},300):b.length===g.length&&e())},!0),a.cancel=function(){c.dismiss("cancel")},a.getPinLength=function(){var a=g.length;return new Array(a)},a.onClickKeys=function(b){var c=a.pin.toString();c=c.concat(b),a.$evalAsync(function(){a.pin=c})}}angular.module("helium").controller("PinCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){var a,c;return h&&angular.forEach(b.Helium.values.mainRoom.events,function(b){var d=b.dtStart-h;c=c||(d>0?d:c),d>0&&d<=c&&(c=d,a=b)}),a}function l(){var a=0,b=$(".reservation__container");return b.length&&(t=t||b[0],a=t.scrollHeight-t.clientHeight-10),a}function m(a){for(var b=[],c=0;c<a;c++)b.push(void 0);return b=b.length?b:[void 0]}function n(b){var c;if(a.reservations&&a.reservations.length)for(var d=a.reservations.length-1;d>=0;d--)if(a.reservations[d].dtEnd<=b){c=a.reservations[d].dtEnd;break}return c||g.getMidnightToday()}function o(a,b,c){var d=new Date(a),e=Math.round(d.getMinutes()/c)*c;return d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(e),d>b&&d.setMinutes(d.getMinutes()-c),d}function p(b){var c,d=g.addMinutesToDate(b>a.reservation.now?b:a.reservation.now,a.cfg.maximumDuration),e=0;for(e=0;e<a.reservations.length;e++)if(a.reservations[e].dtStart>=b){c=a.reservations[e].dtStart;break}return c||(c=g.getMidnightTommorrow()),c=new Date(Math.min(c.getTime(),d.getTime()))}var q=g.getMidnightTommorrow(),r=!1,s=0,t=null,u=b.Helium.settings;a.focusEl=function(c,d){var e;b.$evalAsync(function(){a.activeTimeRoll.selected=c}),setTimeout(function(){e=l(),s=e>s?e:s,s=d?0:s,$(t).animate({scrollTop:s},350)},250)},a.loading={state:!1,message:b.Helium.labels.reservation.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},a.room=i,a.setNow=h,a.reservations=void 0!==i?[]:b.Helium.values.mainRoom.events,a.disableOrganizerEntry="Fusion"!==u.schedule.source&&"fusion"!==u.schedule.source&&"DEMO"!==u.schedule.source&&"Demo"!==u.schedule.source&&"demo"!==u.schedule.source,a.model={subject:"",organizer:"",startDate:null,endDate:null},a.cfg={step:30,customTime:!!h&&u.schedule.reserveCustomEn},a.reservation={now:function(b){var c=a.cfg.step,d=h?b.getMinutes()%c:0,e=new Date(b.getTime()-(d===c?0:60*d*1e3)),f=n(b),g=new Date(Math.max((new Date).getTime(),e.getTime(),f.getTime()));return g.setMilliseconds(0),g.setSeconds(0),g}(h||new Date),lockedStart:void 0===h,startRange:{options:null,value:0},endRange:{options:null,value:0},roomId:void 0!==i?i.id:null},a.cfg.maximumDuration=function(){var b,c;if(h){var d=k();u.reservation&&u.reservation.reserveNowMaxDur&&(c=u.reservation.reserveNowMaxDur),b=d?g.getTotalMinutesBetweenDates(a.reservation.now,d.dtStart):g.getTotalMinutesBetweenDates(a.reservation.now,q),b>c&&(b=c)}else b=u.reservation&&u.reservation.reserveNowMaxDur?u.reservation.reserveNowMaxDur:120;return b}(),a.onKeypress=function(b){if(13===b.which){b.preventDefault();var c=Array.prototype.slice.call($("input[type=text]")),d=c.indexOf(document.activeElement),e=c[d+1];e&&!a.disableOrganizerEntry?e.focus():c[d]&&c[d].blur()}},a.generateStartRange=function(){var b=a.cfg.step,c=a.reservation.now,d=p(c),e=g.getTotalMinutesBetweenDates(c,d),f=function(){return m(Math.min(a.cfg.maximumDuration,e)/b).map(function(a,d){return new Date(+c+d*b*60*1e3)}).filter(function(b){return!a.reservations.some(function(a){return b>=a.dtStart&&b<a.dtEnd||b>q})})}();a.cfg.customTime?(a.reservation.startRange.options=null,a.reservation.startRange.startDate=a.reservation.now,a.reservation.startRange.endDate=g.addMinutesToDate(d,-1),a.model.startDate=c):(a.reservation.startRange.options=f,a.reservation.startRange.value=a.reservation.startRange.options[0])},a.generateEndRange=function(){if(a.model.startDate){var b=a.cfg.step,c=u.reservation.reserveNowEvenEndTime,d=!h&&c?b-a.reservation.now.getMinutes()%b:0,e=new Date(a.model.startDate.getTime()+60*d*1e3),f=p(c?e:a.reservation.now),i=g.getTotalMinutesBetweenDates(e,f),j=function(){var d;(d=m(Math.min(a.cfg.maximumDuration,i)/b).map(function(a,d){return c?new Date(+o(e,e,b)+d*b*60*1e3):new Date(+e+d*b*60*1e3)}).filter(function(b){return!(b<=a.model.startDate||a.reservations.some(function(a){return b>a.dtStart&&e<a.dtEnd||b>q}))}),i<=a.cfg.maximumDuration&&-1===d.indexOf(f))&&(c&&(f=o(f,f,b)),d.length>0&&f>d[d.length-1]?d.push(f):0===d.length&&d.push(f));return d}();if(a.cfg.customTime&&!c){var k=g.getTotalMinutesBetweenDates(e,j[0]);a.reservation.endRange.options=null,a.reservation.endRange.startDate=g.addMinutesToDate(e,k),a.reservation.endRange.endDate=f,a.reservation.endRange.value=a.reservation.endRange.startDate,a.model.endDate=a.reservation.endRange.startDate}else a.reservation.endRange.options=j,a.reservation.endRange.value=j[0]}},a.$watch("model.startDate",function(){a.generateEndRange()}),a.generateStartRange(),a.activeTimeRoll={selected:null,setSelected:function(c){c===b.Helium.labels.reservation.starts&&a.reservation.lockedStart||(a.activeTimeRoll.selected=c)},isSelected:function(b){return a.activeTimeRoll.selected===b}},a.cancel=function(){a.room?(c.dismiss("cancel"),f.closeAll()):c.dismiss("cancel")},a.back=function(){var b=function(){c.dismiss("cancel")};a.reservation.roomId?($(".modal-reservation.slide-right").removeClass("modal-show"),setTimeout(b,350)):b()},a.add=function(){if(!r){b.$evalAsync(function(){r=!1,a.loading.state=!0,angular.extend(b.Helium.state.loading,a.loading)});var c=setTimeout(function(){b.pendingReservation.prevRoomID=0},j.timeoutPendingRoom),d=setTimeout(function(){b.$evalAsync(function(){a.loading.responseReceived||(f.closeAll(),a.loading.showErrorMessageTimeout=!0,a.loading.state=b.Helium.state.loading.state=!1,b.Helium.methods.openMsgError(!0),clearTimeout(c),b.pendingReservation.prevRoomID=0)})},j.timeoutLoadingMask);b.pendingReservation.prevRoomID=a.reservation.roomId,e.sendCreateEvent(!!a.setNow,a.reservation.roomId,a.model.subject?a.model.subject:b.Helium.labels.reservation.defaultSubject,a.model.organizer?a.model.organizer:b.Helium.labels.reservation.defaultOrganizer,a.model.startDate,a.model.endDate,function(c){a.loading.showErrorMessageTimeout||(a.loading.responseReceived=!0,clearTimeout(d),b.$evalAsync(function(){a.loading.state=b.Helium.state.loading.state=!1,r=!1,f.closeAll(),c?!a.setNow&&a.room&&a.room.name&&b.Helium.methods.openMsgSuccess(!0):(b.Helium.methods.openMsgError(!0),b.pendingReservation.prevRoomID=0)}))})}},a.validReservation=function(){return a.model.startDate<a.model.endDate},a.isValidDate=function(a){return a&&a.getTime()===a.getTime()}}angular.module("helium").controller("ReservationCtrl",a),a.$inject=["$scope","$rootScope","$uibModalInstance","TimelineService","CommunicationService","ModalService","DatetimeFactory","setNow","room","AppConfig"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){var a=$(".menu__open");a[0].checked?a[0].checked=!1:a[0].checked=!0}function h(){var a=$(".menu__item--vision");b.Helium.state.vision?(a.addClass("bg__theme-color-6"),a.removeClass("bg__main-color-7")):(a.addClass("bg__main-color-7"),a.removeClass("bg__theme-color-6"))}function i(){var a=$(".menu-close-label"),b=$(".menu__open__button");a.is(":visible")?($(".menu__item").css("visibility","visible"),b[0].setAttribute("style",""),b.css("border","0px")):b[0].setAttribute("style",""),j=setTimeout(function(){var a=$(".menu-close-label"),b=$(".menu-open-label");a.is(":visible")?$(".menu__item").css("visibility","visible"):b.is(":visible")&&$(".menu__item").delay(1).animate({visibility:"visible"},180,function(){$(".menu-close-label").is(":visible")&&$(".menu__item").css("visibility","visible")})},180)}var j,k=function(){a.currentTime=Date.now()},l=!1;a.currentEvent=b.Helium.values.mainRoom.currentEvent,a.nextEvent=b.Helium.values.mainRoom.nextEvent,a.loading={state:!1,message:b.Helium.labels.checkInEvent?b.Helium.labels.checkInEvent.loadingMessage:""};var m=function(){a.currentEvent=b.Helium.values.mainRoom.currentEvent,a.nextEvent=b.Helium.values.mainRoom.nextEvent};b.$watch("Helium.values.mainRoom.currentEvent",function(){m()}),b.$watch("Helium.values.mainRoom.nextEvent",function(){m()}),b.Helium.methods.setMenu(!0),a.currentTime=Date.now(),c.subscribe(k),c.subscribe(b.Helium.state.setRoomReserved),a.openEventDetails=function(a){b.Helium.methods.openModal("details",{event:a})},a.checkInEvent=function(){var c=b.Helium.state.checkInEvent,d=function(){a.checkIn()};if(!c.checkedIn&&b.Helium.state.needPin){var e=b.Helium.methods.openPin();e&&e.result.then(function(){d()})}else d()},a.checkIn=function(){var c=b.Helium.state.checkInEvent;c.checkedIn||l||(b.Helium.methods.closeMenu(),l=!0,a.loading.state=!0,angular.extend(b.Helium.state.loading,a.loading),d.sendCheckInEvent(c.id,c.instanceId,function(d){b.$evalAsync(function(){a.loading.state=b.Helium.state.loading.state=!1,l=!1,d?c.checkedIn=1:b.Helium.methods.openMsgError()})}))},a.endEvent=function(){b.Helium.state.setDisableEndNow()||b.Helium.methods.openEndEvent()},a.extendEvent=function(){b.Helium.state.setDisableExtendNow()||b.Helium.methods.openExtendEvent()},a.isCurrentEventEndingBeforeMidnightToday=function(){return b.Helium.values.mainRoom.currentEvent.dtEnd<f.getMidnightTommorrow()},a.setVision=function(){b.Helium.state.vision=!b.Helium.state.vision,e.updateTheme("impair-theme"),b.$evalAsync(function(){b.Helium.methods.closeMenu()}),h()},a.clickMenu=function(){g(),b.Helium.methods.openMenu(),i()},$(".menu__item").css("visibility","hidden"),"vertical"!==b.Helium.state.layout&&"portrait"!==b.Helium.state.layout||$(".menu__open__button").css("background","transparent"),h(),$(".menu__open").on("click",function(){g()}),a.$on("$destroy",function(){c.unsubscribe(k),c.unsubscribe(b.Helium.state.setRoomReserved),clearTimeout(j)})}angular.module("helium").controller("RoomCtrl",a),a.$inject=["$scope","$rootScope","AppClockService","CommunicationService","ThemeService","DatetimeFactory"]}(),function(){"use strict";function a(a,b,c,d){var e;a.swapFields=!1,a.firstSwap=!1;var f=function(){a.swapFields=!a.swapFields,a.firstSwap=!0},g=function(){e=c(g,3e5),f()};e=c(g,3e5);var h=function(){a.currentTime=Date.now()};a.currentTime=Date.now(),d.subscribe(h),a.goToRoom=function(){b.Helium.methods.openPage("room")},a.getLogo=function(){var a=b.Helium.settings.display.projectIconUrl;return a||""};var i=function(){a.currentEvent=b.Helium.values.mainRoom.currentEvent||null,a.nextEvent=b.Helium.values.mainRoom.nextEvent||null};b.$watch("Helium.values.mainRoom.currentEvent",function(){i()}),
b.$watch("Helium.values.mainRoom.nextEvent",function(){i()}),a.$on("$destroy",function(){d.unsubscribe(h),c.cancel(e)})}angular.module("helium").controller("ScreensaverCtrl",a),a.$inject=["$scope","$rootScope","$timeout","AppClockService"]}(),function(){"use strict";function a(a,b,c,d){var e=setTimeout(function(){b.close()},c.successMsgCloseDelay);a.addEvent=d,a.cancel=function(){b.dismiss("cancel")},a.$on("$destroy",function(){clearTimeout(e)})}angular.module("helium").controller("SuccessMsgCtrl",a),a.$inject=["$scope","$uibModalInstance","AppConfig","addEvent"]}(),function(){"use strict";function a(){return{restrict:"A",replace:!0,scope:{loading:"=",message:"="},template:'<div class="loading bg__theme-color-6"><div class="loading__mask"><i class="loading__mask__img fa fa-spinner fa-pulse fa-3x fa-fw margin-bottom"></i><p class="loading__mask__message">{{ message }}</p></div></div>',link:function(a,b){a.$watch("loading",function(a){a?$(b).show():$(b).hide()})}}}angular.module("helium").directive("hlmLoadingMask",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!1,scope:{duration:"@",callFnShort:"&",callFnLong:"&"},link:function(a,b){var c,d=!0;a.duration=a.duration||5e3,a.callFnShort=a.callFnShort||function(){},a.callFnLong=a.callFnLong||function(){},b[0].addEventListener("touchstart",function(){d=!1,c=setTimeout(function(){d=!0,a.callFnLong()},a.duration)},{passive:!0}),b[0].addEventListener("touchend",function(b){d||(clearTimeout(c),b.preventDefault(),a.callFnShort(b))})}}}angular.module("helium").directive("helLongPressEl",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!0,scope:{scrollDirection:"@",addClassName:"@",removeClassName:"@",childrenClassName:"@",childrenAddClassName:"@",childrenRemoveClassName:"@",disableInteraction:"<",enablePressAction:"<",callPressFn:"&"},link:function(a,b){var c=b?b[0]:null,d={},e=!1;a.scrollDirection=a.scrollDirection||"horizontal",a.addClassName=a.addClassName||"",a.removeClassName=a.removeClassName||"",a.childrenClassName=a.childrenClassName||"",a.childrenAddClassName=a.childrenAddClassName||"",a.childrenRemoveClassName=a.childrenRemoveClassName||"",a.callPressFn=a.callPressFn||function(){};var f,g=function(a){d={},d.pageX=a.touches[0].pageX,d.pageY=a.touches[0].pageY,d.currentTarget=a.currentTarget,d.target=a.target},h=function(){a.callPressFn(d)},i=function(){if(!f&&(f=!0,!0===a.enablePressAction&&!1===e&&h(),$(b).hasClass(a.addClassName)&&($(b).removeClass(a.addClassName),$(b).addClass(a.removeClassName),a.childrenClassName))){var c,d,g=$(b).children();for(c=0;c<g.length;c++)if(-1!==g[c].className.indexOf(a.childrenClassName)){d=$(g[c]),d.removeClass(a.childrenAddClassName),d.addClass(a.childrenRemoveClassName);break}}},j=function(b){if(!a.disableInteraction)if(!a.scrollDirection||"vertical"!==a.scrollDirection&&"portrait"!==a.scrollDirection){var f=d?Math.abs(d.pageX-b.changedTouches.item(0).pageX):0;f>30&&(e=!0)}else{var g=d?Math.abs(d.pageY-b.changedTouches.item(0).pageY):0;g>30&&(e=!0)}e&&(c.removeEventListener("touchmove",j,{passive:!0}),i())},k=function(b){a.disableInteraction||(c.removeEventListener("touchmove",j,{passive:!0}),c.removeEventListener("touchend",k,{passive:!1}),i(),e||b.preventDefault())},l=function(d){if(a.disableInteraction)e=!0,d.stopPropagation();else{if(d.touches.length>1)return void(e=!0);if(e=!1,f=!1,g(d),c.addEventListener("touchmove",j,{passive:!0}),c.addEventListener("touchend",k,{passive:!1}),$(b).removeClass(a.removeClassName),$(b).addClass(a.addClassName),a.childrenClassName){var h,i,l=$(b).children();for(h=0;h<l.length;h++)if(-1!==l[h].className.indexOf(a.childrenClassName)){i=$(l[h]),i.addClass(a.childrenAddClassName),i.removeClass(a.childrenRemoveClassName);break}}}};c.addEventListener("touchstart",l,{passive:!0}),a.$on("destroy",function(){c.removeEventListener("touchstart",l,{passive:!0}),c.removeEventListener("touchmove",j,{passive:!0}),c.removeEventListener("touchend",k,{passive:!1})})}}}angular.module("helium").directive("hlmScrollTouchEl",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!0,scope:{scrollDirection:"@",scrollingPressEvent:"&",disablePress:"<"},link:function(a,b){var c=b?b[0]:null,d={},e=!1;a.scrollDirection=a.scrollDirection||"horizontal",a.scrollingPressEvent=a.scrollingPressEvent||function(){};var f=function(a){d={},d.pageX=a.touches[0].pageX,d.pageY=a.touches[0].pageY,d.currentTarget=a.currentTarget,d.target=a.target},g=function(){e||a.scrollingPressEvent()(d)},h=function(b){if(!a.disablePress&&!e){if(b.touches.length>1)return void(e=!0);if(!a.scrollDirection||"vertical"!==a.scrollDirection&&"portrait"!==a.scrollDirection){(d?Math.abs(d.pageX-b.changedTouches.item(0).pageX):0)>30&&(e=!0)}else{(d?Math.abs(d.pageY-b.changedTouches.item(0).pageY):0)>30&&(e=!0)}e&&c.removeEventListener("touchmove",h,{passive:!0})}},i=function(b){if(!a.disablePress){if(b.touches.length>0)return;c.removeEventListener("touchmove",h,{passive:!0}),c.removeEventListener("touchend",i,{passive:!1}),e||g()}},j=function(b){if(!a.disablePress){if(b.touches.length>1)return void(e=!0);e=!1,f(b),c.addEventListener("touchmove",h,{passive:!0}),c.addEventListener("touchend",i,{passive:!1})}};c.addEventListener("touchstart",j,{passive:!0}),a.$on("destroy",function(){c.removeEventListener("touchstart",j,{passive:!0}),c.removeEventListener("touchmove",h,{passive:!0}),c.removeEventListener("touchend",i,{passive:!1})})}}}angular.module("helium").directive("scrollingPressEvent",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!1,scope:{string:"<",minSize:"<"},link:function(a,b){var c=function(a,b){var d=$(a),e=d.parent(),f=parseFloat(d.css("font-size"));f>b?d.get(0).scrollWidth>Math.ceil(e.width())&&(d.css("fontSize",f-1),c(a,b)):d.addClass("ellipsis")};a.minSize=a.minSize||24,a.$watch("string",function(d){d&&c(b,a.minSize)})}}}angular.module("helium").directive("hlmShrinkToFit",a)}(),function(){"use strict";function a(){}angular.module("helium").controller("SplashCtrl",a),a.$inject=[]}(),function(){"use strict";function a(){return{scope:{data:"=",label:"=",langArabic:"<",formatTime:"<",isSelected:"<"},restrict:"E",replace:!0,template:['<div class="time-roll border__theme-color-4"> <div style="display:none">{{data.value | date: formatTime}}</div><div class="time-roll__center border__theme-color-9"></div><div class="time-roll__top"></div><div class="time-roll__bottom"></div><div class="time-roll__viewport"><ul><li class="color__theme-color-6"><span></span></li><li class="color__theme-color-6" data-ng-repeat="value in data.options track by $index"><span data-ng-if="!langArabic" data-value="{{$index}}">{{formatTime ? (value | date: formatTime) : value}} {{label}}</span><span data-ng-if="langArabic" data-value="{{$index}}">{{label}} {{formatTime ? (value | date: formatTime) : value}} </span></li><li class="color__theme-color-6"><span></span></li></ul></div></div>'].join(""),link:function(a,b){function c(){return b.find(".time-roll__viewport > ul li")}function d(){return n.get(0).scrollTop}function e(a){$(a).addClass(s)}function f(){var a=c();$(a).removeClass(s)}function g(a){var b=a*q;n.animate({scrollTop:b},300)}function h(a){clearTimeout(l),l=setTimeout(i,700,a)}function i(){var a=d();0===m&&(a%q>r?n.animate({scrollTop:a+q-a%q},100):n.animate({scrollTop:a-a%q},100))}function j(){var c,g=d();c=g%q>r?(g+q-g%q)/q+2:(g-g%q)/q+2,f(),e(b.find(".time-roll__viewport > ul li:nth-child("+Math.round(c)+")")),a.data.value!==a.data.options[Math.round(c)-1-1]&&(a.data.value=a.data.options[Math.round(c)-1-1],a.$apply())}function k(){++m,clearTimeout(l)}var l,m=0,n=b.find(".time-roll__viewport"),o=n?n[0]:null,p=n.find("li").first(),q=p.height(),r=q/2,s="time-roll__viewport__selected";a.$watch("data.options",function(){f(),g(0),e(b.find(".time-roll__viewport > ul li:nth-child(2)"))}),a.$watch("isSelected",function(){setTimeout(function(){var a=b.parent(),c=a.find(".time-roll__viewport ul");c&&(c.css("display","none"),c.offset(),c.css("display",""))},100)}),function(){n.bind("scroll",j),o&&o.addEventListener("touchstart",k,{passive:!0}),n.bind("touchend",function(){m=0,h()})}()}}}angular.module("helium").directive("hlmTimeRoll",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!0,scope:{addClassName:"@",removeClassName:"@",childrenClassName:"@",childrenAddClassName:"@",childrenRemoveClassName:"@",disableInteraction:"<",enablePressAction:"<",enableLongPressAction:"<",duration:"@",callFnShort:"&",callFnLong:"&"},link:function(a,b){var c,d=!0,e=b?b[0]:null;a.addClassName=a.addClassName||"",a.removeClassName=a.removeClassName||"",a.childrenClassName=a.childrenClassName||"",a.childrenAddClassName=a.childrenAddClassName||"",a.childrenRemoveClassName=a.childrenRemoveClassName||"",a.duration=a.duration||2e3,a.enableLongPressAction=a.enableLongPressAction||!1,a.callFnShort=a.callFnShort||function(){},a.callFnLong=a.callFnLong||function(){};var f=function(g){e.removeEventListener("touchend",f,{passive:!1}),!0!==a.disableInteraction&&window.requestAnimationFrame(function(){if($(b).removeClass(a.addClassName),$(b).addClass(a.removeClassName),a.childrenClassName){var e,f,h=$(b).children();for(e=0;e<h.length;e++)if(-1!==h[e].className.indexOf(a.childrenClassName)){f=$(h[e]),f.removeClass(a.childrenAddClassName),f.addClass(a.childrenRemoveClassName);break}}!0===a.enablePressAction&&(d||(clearTimeout(c),a.callFnShort(g)))})},g=function(){e.addEventListener("touchend",f,{passive:!1}),!0!==a.disableInteraction&&window.requestAnimationFrame(function(){if($(b).removeClass(a.removeClassName),$(b).addClass(a.addClassName),a.childrenClassName){var e,f,g=$(b).children();for(e=0;e<g.length;e++)if(-1!==g[e].className.indexOf(a.childrenClassName)){f=$(g[e]),f.addClass(a.childrenAddClassName),f.removeClass(a.childrenRemoveClassName);break}}!0===a.enablePressAction&&(d=!1,c=setTimeout(function(){!0===a.enableLongPressAction&&(d=!0,a.callFnLong())},a.duration))})};e.addEventListener("touchstart",g,{passive:!0})}}}angular.module("helium").directive("hlmTouchEl",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!1,scope:{touchEndFn:"&"},link:function(a,b){var c=b?b[0]:null;a.touchEndFn=a.touchEndFn||function(){};var d=function(){a.$apply(function(){a.$eval(a.touchEndFn)})};c.addEventListener("touchend",d,{passive:!1})}}}angular.module("helium").directive("elTouchEnd",a)}(),function(){"use strict";function a(){return{restrict:"A",replace:!0,scope:{hlmVideoPoster:"="},link:function(a,b){a.$watch("hlmVideoPoster",function(a){a&&b.attr("poster",a)}),a.hlmVideoPoster=a.hlmVideoPoster||"",b.attr("poster",a.hlmVideoPoster)}}}angular.module("helium").directive("hlmVideoPoster",a)}(),function(){"use strict";angular.module("helium").factory("DatetimeFactory",function(){return this.getMidnightToday=function(){var a=new Date;return a.setHours(0,0,0,0),a},this.getMidnightTommorrow=function(){var a=new Date;return a.setHours(24,0,0,0),a},this.isNowBetweenDates=function(a,b){var c=new Date;return a<c&&c<=b},this.getRoundTimeLeftTill=function(a){var b=(new Date).getTime();return this.getTimeLeftBetweenDates(a,b-6e4)},this.getTimeLeftTill=function(a){var b=(new Date).getTime();return this.getTimeLeftBetweenDates(a,b)},this.getTotalMinutesBetweenDates=function(a,b){var c=a%6e4,d=b%6e4;c&&void 0!==c&&0!==c&&(a-=c),d&&void 0!==d&&0!==d&&(b-=d);var e=Math.abs(b-a)/1e3;return Math.floor(e/60)},this.getTimeLeftBetweenDates=function(a,b){var c=Math.abs(a-b)/1e3,d=Math.floor(c/3600)%24;c-=3600*d;var e=Math.floor(c/60)%60;return c-=60*e,{hours:d,minutes:e,seconds:c%60}},this.addMinutesToDate=function(a,b){return new Date(a.getTime()+6e4*b)},this.isDateBeforeDate=function(a,b){return a<=b},this})}(),function(){"use strict";angular.module("helium").factory("UtilFactory",function(){return this.getControllerModal=function(a){var b=a?a.split("-"):[],c="",d=0;for(d;d<b.length;d++)c+=this.capitalizeFirstLetter(b[d]);return c?c+"Ctrl":c},this.capitalizeFirstLetter=function(a){return a?a.charAt(0).toUpperCase()+a.slice(1):a},this.isString=function(a){return"string"==typeof a||a instanceof String},this.existClass=function(){return!0},this.existsTemplate=function(){return!0},this})}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h=!1;b.listenForActions(),b.createMethods(),c.path("page/splash"),f.loadTheme(),g.loadLayout(),b.setTimelineBlockDimensions();var i=function(){b.startScreensaverTimeout(),d[0].removeEventListener("touchend",i,{passive:!1}),d[0].removeEventListener("touchcancel",i,{passive:!1})},j=function(){b.stopScreensaverTimeout(),d[0].addEventListener("touchend",i,{passive:!1}),d[0].addEventListener("touchcancel",i,{passive:!1})};a.$on("$locationChangeStart",function(){h=!0,e.closeAll(),a.Helium.state.loading.state=!1}),a.$on("$routeChangeSuccess",function(){h||e.closeAll(),h=!1}),a.$on("$routeChangeError",function(b,c,d){a.Helium.methods.openPage(d.params.page)}),d[0].addEventListener("touchstart",j,{passive:!0}),a.$on("destroy",function(){d[0].removeEventListener("touchstart",j,{passive:!0}),d[0].removeEventListener("touchend",i,{passive:!1}),d[0].removeEventListener("touchcancel",i,{passive:!1})})}angular.module("helium").run(a),a.$inject=["$rootScope","AppStateService","$location","$document","ModalService","ThemeService","LayoutService"]}(),function(){"use strict";function a(a){var b,c=[],d=!1,e=function(){for(var a=0;a<c.length;a++)try{c[a]()}catch(a){console.log("AppClockService: Exception while processing a callback function: "+a)}},f=function(){e();var c=60500-(new Date).getTime()%6e4;b=a(f,c)},g=function(){d&&(a.cancel(b),d=!1)},h=function(){d&&g(),e();var c=60500-(new Date).getTime()%6e4;b=a(f,c),d=!0};this.subscribe=function(a){c.length||h(),c.push(a)},this.unsubscribe=function(a){for(var b=c.length;b>=0;b--)if(c[b]===a){c.splice(b,1);break}c.length||g()}}angular.module("helium").service("AppClockService",a),a.$inject=["$timeout"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){var b=a.Helium.state.buttons.disable,c=a.Helium.state.isOnline;a.Helium.state.setVisibleEndNow(),a.Helium.state.setVisibleExtendNow(),a.Helium.state.setVisibleCheckInNow(),a.Helium.state.setDisableEndNow(),a.Helium.state.setDisableExtendNow(),a.Helium.state.setDisableCheckIn(),b.findRoom=!c,b.reserveNow=!c}function q(){p(),a.Helium.state.setRoomReserved()}var r,s=this,t={config:!1,providerStatus:!1},u=!1;a.Helium={methods:{},language:{},settings:{countDownScreenSaver:j.screenSaverDelay,schedule:{source:""}},settingsExtra:{supportsInstanceManipulation:!1,readOnlyModeEnabled:!1},labels:{},values:{mainRoom:{events:[],currentEvent:null,nextEvent:null}},state:{layout:"",portraitPanel:!1,countOpenModals:0,modalOpen:!1,help:!1,loading:{state:!1,message:"Loading"},isOnline:!0,roomOccupied:!1,isArabic:!1,buttons:{disable:{}},needPin:!1,checkInEvent:null,openAbout:!1,refreshingProvider:!1,timelineBlockHorizontalSize:322,timelineBlockVerticalSize:113}},a.pendingReservation={prevRoomID:0},o.subscribe(function(){q()}),a.$watch("Helium.values.mainRoom.currentEvent",q),a.$watch("Helium.values.mainRoom.currentEvent.privacyLevel",q),a.$watch("Helium.values.mainRoom.nextEvent",q),a.$watch("Helium.values.mainRoom.currentEvent.checkedIn",p),a.$watch("Helium.values.mainRoom.nextEvent.checkedIn",p),a.$watch("Helium.state.isOnline",p),a.$watch("Helium.values.mainRoom.currentEvent.dtEnd",p),this.setTimelineBlockDimensions=function(){var b=window.screen?window.screen.width:0,c=window.screen?window.screen.height:0;if(a.Helium.state.portraitPanel=c>=b,a.Helium.state.portraitPanel)switch(c){case 1280:a.Helium.state.timelineBlockHorizontalSize=322,a.Helium.state.timelineBlockVerticalSize=113;break;case 640:a.Helium.state.timelineBlockHorizontalSize=160,a.Helium.state.timelineBlockVerticalSize=70}else switch(c){case 800:case 739:a.Helium.state.timelineBlockHorizontalSize=322,a.Helium.state.timelineBlockVerticalSize=113;break;case 363:a.Helium.state.timelineBlockHorizontalSize=160,a.Helium.state.timelineBlockVerticalSize=68}},this.listenForActions=function(){var b=function(){t.config&&t.providerStatus&&h(function(){u=!0,a.Helium.methods.openPage("room"),s.startScreensaverTimeout()},2500)};i.listenForProviderStatus(function(c){t.config=!0,a.$evalAsync(function(){a.Helium.state.vision=!1,k.applyProviderState(c),b(),n.applyBackground()})}),i.listenForTimeline(function(b){a.$evalAsync(function(){g.applyRoomTimeline(b.data)})}),i.listenForEvents(function(b){a.$evalAsync(function(){g.applyRoomEvents(b.data)})}),i.listenForConfig(function(c){a.$evalAsync(function(){a.Helium.state.vision=!1,t.providerStatus=!0,f.changeLanguage(c.data.settings.room,function(){k.applySettings(c.data),q(),k.setNeedsPin(c.data),k.isFirstInitialization()&&s.startScreensaverTimeout(),b(),n.applyBackground()}),g.refreshStateOnCurrentMeeting()})})},this.createMethods=function(){function f(a){var b=$(".menu__open__button");a?b.removeClass("bg__main-color-8"):b.addClass("bg__main-color-8")}function i(){var b,c,d=a.Helium.values.mainRoom.nextEvent,e=a.Helium.settings.automation&&a.Helium.settings.automation.forceOrgCheckInMin,f=!1;return d&&(b=new Date,c=l.getTotalMinutesBetweenDates(b,d.dtStart),e&&angular.isNumber(e)&&c<=e&&(d.state.visibleCheckInNow=!0,a.Helium.state.checkInEvent=d,f=!0)),f}a.Helium.methods.openPage=function(a){u&&b.path("/page/"+a)};var j=!1;a.Helium.methods.openModal=function(b,f,g){if(j)return void console.log("AppState: openModal: "+b+". Already working on previous request. Return");var h,i=e.getControllerModal(b),k=d.getModalTemplateUrl(b),l=$("main");return a.Helium.methods.closeMenu(),e.existClass(i)&&k&&(j=!0,setTimeout(function(){j=!1},250),h=c.open(angular.extend({animation:!0,backdrop:"static",keyboard:!1,templateUrl:k,controller:i,windowClass:"modal-"+b,resolve:f||{}},g)),h.opened.then(function(){a.Helium.state.countOpenModals++,l.addClass("blur"),a.Helium.state.modalOpen=!0}),h.closed.then(function(){--a.Helium.state.countOpenModals<1&&(l.removeClass("blur"),a.Helium.state.modalOpen=!1,a.Helium.state.countOpenModals<0&&(a.Helium.state.countOpenModals=0))})),h},a.Helium.methods.openEndEvent=function(){var b=function(){a.Helium.methods.openModal("end-event").result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})};if(a.Helium.state.needPin){var c=a.Helium.methods.openPin();c&&c.result.then(function(){b()})}else b()},a.Helium.methods.openExtendEvent=function(){var b=function(){a.Helium.values.mainRoom.currentEvent.state.maxExtend&&a.Helium.methods.openModal("extend-event").result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})};if(a.Helium.state.needPin){var c=a.Helium.methods.openPin();c&&c.result.then(function(){b()})}else b()},a.Helium.methods.openHelp=function(){var b=function(){document.removeEventListener("touchend",b),a.$evalAsync(function(){a.Helium.state.help=!1})};a.Helium.methods.closeMenu(),a.$evalAsync(function(){a.Helium.state.help=!0}),setTimeout(function(){document.addEventListener("touchend",b)},10)},a.Helium.methods.closeHelp=function(){a.$evalAsync(function(){a.Helium.state.help=!1})},a.Helium.methods.openReservation=function(b,c){var d=a.Helium.settings.room,e=a.Helium.values.mainRoom;if(b&&a.Helium.state.isReserved()&&d&&d.availabilityThresholdRoomState&&l.isDateBeforeDate(b,e.currentEvent.dtStart)&&l.getTotalMinutesBetweenDates(b,e.currentEvent.dtStart)<=d.availabilityThresholdMin)return!1;var f=function(){var d=c?{windowClass:"modal-reservation slide-right",animation:!1}:{};if(a.Helium.state.isOnline){var e=a.Helium.methods.openModal("reservation",{setNow:function(){return b},room:function(){return c}},d);e.result.catch(function(a){if(-1===["cancel","backdrop click","escape key press","undefined"].indexOf(a))throw a}),c&&e.rendered.then(function(){$(".modal-reservation.slide-right").addClass("modal-show")})}};if(!c&&a.Helium.state.needPin){var g=a.Helium.methods.openPin();g&&g.result.then(function(){f()})}else f()},a.Helium.methods.openFindRoom=function(){var b=function(){a.Helium.methods.openModal("find-room").result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})};if(a.Helium.state.needPin){var c=a.Helium.methods.openPin();c&&c.result.then(function(){b()})}else b()},a.Helium.methods.openAbout=function(){a.Helium.methods.closeHelp(),a.Helium.methods.closeMenu();var b=a.Helium.methods.openModal("about");b.opened.then(function(){a.Helium.state.openAbout=!0}),b.closed.then(function(){a.Helium.state.openAbout=!1}),b.result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})},a.Helium.methods.openMsgError=function(b){a.Helium.methods.openModal("error-msg",{addEvent:function(){return b}}).result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})},a.Helium.methods.openMsgSuccess=function(b){a.Helium.methods.openModal("success-msg",{addEvent:function(){return b}}).result.catch(function(a){if(-1===["cancel","backdrop click","escape key press"].indexOf(a))throw a})},a.Helium.methods.openPin=function(){return!!a.Helium.state.isOnline&&a.Helium.methods.openModal("pin",null,{backdropClass:"modalOpacity",backdrop:"true"})},this.startScreensaverTimeout=function(){h.cancel(r),r=h(function(){a.Helium.state.vision=!1,m.loadTheme(),a.Helium.methods.openPage("screensaver")},a.Helium.settings.countDownScreenSaver)},this.stopScreensaverTimeout=function(){h.cancel(r)},this.setRefreshProviderTimeout=function(){a.Helium.state.refreshingProvider=!0,setTimeout(function(){a.Helium.state.refreshingProvider=!1},3e4)},a.Helium.methods.openMenu=function(){var b=$(".menu__open"),c=$(".menu__overlay");b.length&&b.is(":checked")?(a.Helium.methods.setMenu(!1),c.length&&c.addClass("menu__overlay--display")):(a.Helium.methods.setMenu(!0),c.removeClass("menu__overlay--display"))},a.Helium.methods.closeMenu=function(){var b=$(".menu__open"),c=$(".menu__overlay");b.length&&b.is(":checked")&&($(".menu__open").prop("checked",!1),c.length&&c.removeClass("menu__overlay--display")),a.Helium.methods.setMenu(!0)},a.Helium.methods.setMenu=function(b){f(b),setTimeout(function(){a.Helium.methods.setMenuItemVisibility(b)},180)},a.Helium.methods.setMenuItemVisibility=function(b){var c=$(".menu__open__button"),d=$(".menu-close-label");b?$(".menu__item").delay(1).animate({visibility:"hidden"},0,function(){d.is(":visible")?window.requestAnimationFrame(function(){$(".menu__item").css("visibility","visible"),c.css("border","0px")}):($(".menu__item").css("visibility","hidden"),window.requestAnimationFrame(function(){c[0].setAttribute("style",""),"vertical"!==a.Helium.state.layout&&"portrait"!==a.Helium.state.layout||c[0].setAttribute("style","background: transparent")}))}):"vertical"!==a.Helium.state.layout&&"portrait"!==a.Helium.state.layout||window.requestAnimationFrame(function(){$(".menu__item").css("visibility","visible"),c[0].setAttribute("style",""),c.css("border","0px")})},a.Helium.state.isReserved=function(){return g.isReserved()},a.Helium.state.isAvailable=function(){return g.isAvailable()},a.Helium.state.isAvailableForTheRestOfTheDay=function(){return g.isAvailableForTheRestOfTheDay()},a.Helium.state.getRemainingTimeString=function(b){var c=new Date,d=l.getTimeLeftBetweenDates(c,b.dtEnd),e="";return d&&d.hours>0&&(e+=d.hours+" ",e+=d.hours>1?a.Helium.labels.hours:a.Helium.labels.hour,e+=" "+a.Helium.labels.and+" "),e+=d.minutes+1+" ",e+=d.minutes>1?a.Helium.labels.minutes:a.Helium.labels.minute},a.Helium.state.setVisibleEndNow=function(){if(a.Helium.settingsExtra.readOnlyModeEnabled)return!1;var b=a.Helium.settings.reservation&&a.Helium.settings.reservation.endEarlyType,c=a.Helium.values.mainRoom?a.Helium.values.mainRoom.currentEvent:null;if(null===c)return!1;if(c&&!a.Helium.settingsExtra.supportsInstanceManipulation&&c.isRecurring)return!1;if(a.Helium.settings.room&&a.Helium.settings.room.availabilityThresholdRoomState&&a.Helium.values.mainRoom.nextEvent&&a.Helium.values.mainRoom.currentEvent&&a.Helium.values.mainRoom.nextEvent.id===a.Helium.values.mainRoom.currentEvent.id)return c.state.visibleEndNow=!1,!1;if(a.Helium.state.isReserved()&&b&&"off"!==b.toLowerCase()){var d=new Date,e=l.getTotalMinutesBetweenDates(c.dtStart,c.dtEnd),f=d>c.dtStart?l.getTotalMinutesBetweenDates(c.dtStart,d):0;if("minutes"===b.toLowerCase()){var g=a.Helium.settings.reservation.freeUpRoomEnMin;if(angular.isNumber(g)&&f>=g)return c.state.visibleEndNow=!0,!0}else if("percentage"===b.toLowerCase()){var h,i=a.Helium.settings.reservation.freeUpRoomEnPer;if(angular.isNumber(i)&&(h=i/100*e),angular.isNumber(h)&&f>=h)return c.state.visibleEndNow=!0,!0}}return c.state.visibleEndNow=!1,!1},a.Helium.state.setDisableEndNow=function(){var b=a.Helium.state.buttons.disable,c=a.Helium.state.isOnline,d=!1;a.Helium.values.mainRoom.currentEvent&&!a.Helium.settingsExtra.supportsInstanceManipulation&&a.Helium.values.mainRoom.currentEvent.isRecurring&&(d=!0);var e=c?d:!c;return b.end=e,e},a.Helium.state.setVisibleExtendNow=function(){if(a.Helium.settingsExtra.readOnlyModeEnabled)return!1;var b=a.Helium.settings.reservation,c=b&&b.extendReservationType,d=a.Helium.values.mainRoom?a.Helium.values.mainRoom.currentEvent:null;if(null===d)return!1;if(d&&!a.Helium.settingsExtra.supportsInstanceManipulation&&d.isRecurring)return!1;if(a.Helium.settings.room&&a.Helium.settings.room.availabilityThresholdRoomState&&a.Helium.values.mainRoom.nextEvent&&a.Helium.values.mainRoom.currentEvent&&a.Helium.values.mainRoom.nextEvent.id===a.Helium.values.mainRoom.currentEvent.id)return d.state.visibleExtendNow=!1,!1;if(a.Helium.state.isReserved()&&c&&"off"!==c.toLowerCase()){var e,f=new Date,g=l.getTotalMinutesBetweenDates(d.dtEnd,d.dtStart),h=f>d.dtStart?Math.round(l.getTotalMinutesBetweenDates(d.dtStart,f)):0,i=g-h,j=function(a){return i<=0?(d.state.visibleExtendNow=!1,!1):a>=i?(d.state.visibleExtendNow=!0,!0):(d.state.visibleExtendNow=!1,!1)};if("minutes"===c.toLowerCase())return e=angular.isNumber(b.extendReservationMinAfter)?b.extendReservationMinAfter:0,j(e);if("percentage"===c.toLowerCase()){var k=angular.isNumber(b.extendReservationPerAfter)?b.extendReservationPerAfter:0;return e=Math.max(1,Math.round(k/100*g)),j(e)}}return d.state.visibleExtendNow=!1,!1},a.Helium.state.setDisableExtendNow=function(){var b=a.Helium.state.buttons.disable,c=a.Helium.state.isOnline,d=!1,e=a.Helium.values.mainRoom.currentEvent,f=a.Helium.values.mainRoom.nextEvent,g=f&&e?l.getTotalMinutesBetweenDates(e.dtEnd,f.dtStart):-1;return(e&&!a.Helium.settingsExtra.supportsInstanceManipulation&&e.isRecurring||f&&e&&0===g)&&(d=!0),b.extend=c?d:!c,b.extend},a.Helium.state.setVisibleCheckInNow=function(){if(!a.Helium.settings.automation||!a.Helium.settings.automation.forceOrgCheckIn)return a.Helium.state.checkInEvent=null,!1;if(a.Helium.state.isReserved()){var b=a.Helium.values.mainRoom.currentEvent,c=new Date,d=c>b.dtStart?l.getTotalMinutesBetweenDates(b.dtStart,c):-1,e=a.Helium.settings.automation.forceOrgCheckInEndMin;if(e&&angular.isNumber(e)){if(d>=0&&d<e)return b.state.visibleCheckInNow=!0,a.Helium.state.checkInEvent=b,!0;if(i())return b.state.visibleCheckInNow=!1,!0}else if(i())return b.state.visibleCheckInNow=!1,!0;return b.state.visibleCheckInNow=!1,a.Helium.state.checkInEvent=null,!1}return a.Helium.state.isAvailable()?(a.Helium.state.checkInEvent=null,i()):void 0},a.Helium.state.setDisableCheckIn=function(){var b=a.Helium.state.buttons.disable,c=a.Helium.state.isOnline,d=a.Helium.values.mainRoom,e=!1;return d.currentEvent&&d.currentEvent.state.visibleCheckInNow?e=d.currentEvent.checkedIn:d.nextEvent&&d.nextEvent.state.visibleCheckInNow&&(e=d.nextEvent.checkedIn),b.checkIn=c?e:!c,b.checkIn},a.Helium.state.setRoomReserved=function(){var b=a.Helium.settings.room&&a.Helium.settings.room.availabilityThresholdMin?a.Helium.settings.room.availabilityThresholdMin:0,c=(new Date).getTime(),d=a.Helium.values.mainRoom.nextEvent,e=d?l.getTotalMinutesBetweenDates(c,d.dtStart):l.getTotalMinutesBetweenDates(c,l.getMidnightTommorrow());return a.Helium.state.isAvailable()&&a.Helium.settings.room&&a.Helium.settings.room.availabilityThresholdRoomState?b&&void 0!==b&&angular.isNumber(b)&&e<=b&&g.setCurrentEvent(d):a.Helium.state.isReserved()&&a.Helium.values.mainRoom.nextEvent&&a.Helium.values.mainRoom.currentEvent&&a.Helium.values.mainRoom.nextEvent.id===a.Helium.values.mainRoom.currentEvent.id&&(a.Helium.settings.room.availabilityThresholdRoomState?b&&void 0!==b&&angular.isNumber(b)&&e>b&&g.setCurrentEvent(null):g.setCurrentEvent(null)),!1}}}angular.module("helium").service("AppStateService",a),a.$inject=["$rootScope","$location","$uibModal","templateService","UtilFactory","LocalizationService","TimelineService","$timeout","CommunicationService","AppConfig","SettingsService","DatetimeFactory","ThemeService","BackgroundService","AppClockService"]}(),function(){"use strict";function a(a){function b(a){"image"===a.mediaType.toLowerCase()?l(a.url):"video"===a.mediaType.toLowerCase()&&m(a)}function c(a){"image"===a.mediaType.toLowerCase()?n(a.url):"video"===a.mediaType.toLowerCase()&&o(a)}var d,e,f,g,h="",i=function(){a.Helium.state.theme&&(h="assets/images/"+a.Helium.state.theme+".png"),h=a.Helium.state.vision?"assets/images/dark-theme.png":h},j=function(){a.Helium.settings.screenSaverBg||(a.Helium.settings.screenSaverBg={img:{},media:{}}),d=a.Helium.settings.screenSaverBg.img,e=a.Helium.settings.screenSaverBg.media},k=function(){a.Helium.settings.roomBg||(a.Helium.settings.roomBg={img:{},media:{}}),f=a.Helium.settings.roomBg.img,g=a.Helium.settings.roomBg.media},l=function(a){j(),angular.extend(e,{video:"",type:"",poster:""}),angular.extend(d,{src:a})},m=function(a){var b=document.getElementsByClassName("screensaver__video");j(),i(),angular.extend(d,{src:""}),angular.extend(e,{video:a.url,type:a.mediaSubType,poster:h}),b.length&&b[0].load()},n=function(a){k(),angular.extend(g,{video:"",type:"",poster:""}),angular.extend(f,{src:a})},o=function(b){var c=document.getElementsByClassName("room__video");k(),i(),a.Helium.settings.roomBg.img.src="",angular.extend(f,{src:""}),angular.extend(g,{video:b.url,type:b.mediaSubType,poster:h}),c.length&&c[0].load()};this.applyBackground=function(){this.setBackground()},this.setBackground=function(){var d=a.Helium.settings.display,e=d?d.backgrounds:null;angular.isObject(e)?(l("assets/images/bg.jpg"),n("assets/images/bg.jpg"),a.Helium.state.isReserved()?(e.reservedActive&&e.reservedActive.enabled&&c(e.reservedActive),e.reservedIdle&&e.reservedIdle.enabled&&b(e.reservedIdle)):a.Helium.state.roomOccupied?(e.availableActiveOccupied&&e.availableActiveOccupied.enabled?c(e.availableActiveOccupied):e.availableActive&&e.availableActive.enabled&&c(e.availableActive),e.availableIdleOccupied&&e.availableIdleOccupied.enabled?b(e.availableIdleOccupied):e.availableIdle&&e.availableIdle.enabled&&b(e.availableIdle)):(e.availableActive&&e.availableActive.enabled&&c(e.availableActive),e.availableIdle&&e.availableIdle.enabled&&b(e.availableIdle))):(l("assets/images/bg.jpg"),n("assets/images/bg.jpg"))}}angular.module("helium").service("BackgroundService",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(){var a=SchedulingPanel.webUI,b=function(b){var c=function(){a.unsubscribe.data.timeline(c),a.unsubscribe.data.providerStatus(c),b()};a.subscribe.data.timeline(c,!1),a.subscribe.data.providerStatus(c,!1)};this.listenForConfig=function(b){a.subscribe.data.config(b)},this.listenForLanguage=function(b){a.subscribe.data.language(b)},this.listenForTimeline=function(b){a.subscribe.data.timeline(b)},this.listenForProviderStatus=function(b){a.subscribe.data.providerStatus(b)},this.listenForEvents=function(b){a.subscribe.data.events(b)},this.sendExtendEvent=function(c,d,e,f){a.send.action.extendEvent(c.toString(),null===d?null:d.toString(),e.toString(),function(a,c){a?b(function(){f(a,c)}):f(a,c)})},this.sendEndEvent=function(c,d,e){
a.send.action.endEvent(c.toString(),null===d?null:d.toString(),function(a,c){a?b(function(){e(a,c)}):e(a,c)})},this.sendCreateEvent=function(c,d,e,f,g,h,i){a.send.action.createEvent(c,null===d?null:d.toString(),e.toString(),f.toString(),g.getTime(),h.getTime(),function(a,c){a&&null===d?b(function(){i(a,c)}):i(a,c)})},this.sendRoomSearch=function(b,c){a.send.action.roomSearch(b.toString(),c)},this.sendDetailsEvent=function(b,c,d){a.send.action.detailsEvent(b.toString(),null===c?null:c.toString(),d)},this.sendCheckInEvent=function(b,c,d){a.send.action.checkInEvent(b.toString(),null===c?null:c.toString(),d)},this.sendOpenSettings=function(){a.send.action.openSettings()},this.sendAbout=function(b){a.send.action.statusScreenInfo(b)},this.sendRefreshSchedule=function(b){a.send.action.refreshSchedule(b)}}angular.module("helium").service("CommunicationService",a)}(),function(){"use strict";function a(a){this.updateLayout=function(b){var c=b?"vertical":"horizontal";a.Helium.state.portraitPanel&&(c="portrait"),a.Helium.state.layout=c,localStorage.setItem("layout",c)},this.loadLayout=function(){a.Helium.state.layout=localStorage.getItem("layout")||"horizontal"}}angular.module("helium").service("LayoutService",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(a,b,c,d,e){function f(b){a.Helium.labels=b}function g(a){return c.get("assets/translations/"+a+".json")}var h;this.changeLanguage=function(c,i){var j=c.language,k=c.rtl,l=function(){b.set(j),d.arabicLanguage="iw"===j||"he"===j||"ar"===j,a.Helium.state.isArabic=d.arabicLanguage,a.isRtl=k};j=j||"en-us",j=j.toLowerCase().split("_").join("-"),g(j).then(function(a){h=j,l(),f(a.data),e.reload(),i()},function(){g(h||"en-us").then(function(a){l(),f(a.data),e.reload(),i()},function(){i()})})}}angular.module("helium").service("LocalizationService",a),a.$inject=["$rootScope","tmhDynamicLocale","$http","AppConfig","$route"]}(),function(){"use strict";function a(a){this.closeAll=function(){a.dismissAll()}}angular.module("helium").service("ModalService",a),a.$inject=["$uibModalStack"]}(),function(){"use strict";function a(a,b,c,d){function e(){a.Helium.settings=angular.extend({},f.settings,{countDownScreenSaver:f.settings&&f.settings.room&&f.settings.room.idleTimeoutMinutes?60*f.settings.room.idleTimeoutMinutes*1e3:b.screenSaverDelay}),f.settings&&f.settings.room&&f.settings.room.name&&(a.Helium.values.roomName=f.settings.room.name)}var f,g,h=0;this.isFirstInitialization=function(){return 1===h},this.applySettings=function(b){if(b){var g=b.settings.room;switch(g.timeFormat?(g.timeFormat="h:mm a",g.hoursFormat="h",g.hoursAmpmFormat="h a",g.ampmFormat="a"):(g.timeFormat="HH:mm",g.hoursFormat="HH",g.hoursAmpmFormat="HH",g.ampmFormat=""),g.minutesFormat="mm",g.dateFormat){case"WMDY":g.dateFormat=a.Helium.state.isArabic?" y, EEEE, dd MMMM":"EEEE, MMMM dd, y";break;case"WDMY":g.dateFormat=a.Helium.state.isArabic?"EEEE, y-MMMM-dd":"EEEE, dd-MMMM-y";break;case"WYMD":g.dateFormat=a.Helium.state.isArabic?"EEEE, dd-MMMM-y":"EEEE, y-MMMM-dd";break;case"WMD":g.dateFormat=a.Helium.state.isArabic?"EEEE, dd MMMM":"EEEE, MMMM dd";break;case"WDM":g.dateFormat=a.Helium.state.isArabic?"EEEE, MMMM-dd":"EEEE, dd-MMMM";break;case"MDY":g.dateFormat=a.Helium.state.isArabic?"y, dd MMMM":"MMMM dd, y";break;case"DMY":g.dateFormat=a.Helium.state.isArabic?"y-MMMM-dd":"dd-MMMM-y";break;case"YMD":g.dateFormat=a.Helium.state.isArabic?"dd-MMMM-y":"y-MMMM-dd";break;case"M.DY":g.dateFormat=a.Helium.state.isArabic?"y dd MMMM":"MMMM.dd y";break;case"D.MY":g.dateFormat=a.Helium.state.isArabic?"y MMMM.dd":"dd.MMMM y";break;default:g.dateFormat=a.Helium.state.isArabic?"EEEE, y, dd MMMM":"fullDate"}f=b,e(),this.applySettingsExtras(a.Helium.settings.extras),d.loadTheme(g.theme),c.updateLayout(g.verticalOrientation),this.applyCustomCss(g.styleOverrideUrl),h<2&&h++}},this.applySettingsExtras=function(b){g=b,a.Helium.settingsExtra=angular.extend({},g)},this.applyCustomCss=function(b){a.Helium.state.customCss=b?b+"?v="+(new Date).getTime():"custom.css"},this.setNeedsPin=function(b){var c=b.settings.accessControl;c&&c.securityLevel&&"anonymous"===c.securityLevel.toLowerCase()?a.Helium.state.needPin=!1:a.Helium.state.needPin=!0},this.applyProviderState=function(b){var c=b.data;a.Helium.state.isOnline=c.isOnline,a.Helium.state.needsAuthorization=c.needsAuthorization,a.Helium.state.offlineLimit=c.offlineLimit,a.Helium.state.roomOccupied=c.roomOccupied,a.Helium.state.offlineLimit&&a.$evalAsync(function(){a.Helium.methods.openPage("room")})}}angular.module("helium").service("SettingsService",a),a.$inject=["$rootScope","AppConfig","LayoutService","ThemeService"]}(),function(){"use strict";function a(a,b){this.getPageTemplateUrl=function(c){var d=b.template,e=b.arabicLanguage&&void 0!==a.get(d.pageFolderPath+c+d.arabicTemplateSuffix+".html"),f=d.pageFolderPath+c+(e?d.arabicTemplateSuffix:"")+".html";return void 0!==a.get(f)?f:null},this.getModalTemplateUrl=function(c){var d=b.template,e=b.arabicLanguage&&void 0!==a.get(d.modalFolderPath+c+d.arabicTemplateSuffix+".html"),f=d.modalFolderPath+c+(e?d.arabicTemplateSuffix:"")+".html";return void 0!==a.get(f)?f:null}}angular.module("helium").service("templateService",a),a.$inject=["$templateCache","AppConfig"]}(),function(){"use strict";function a(a){this.updateTheme=function(b){a.Helium.state.vision?a.Helium.state.theme=b:this.loadTheme()},this.loadTheme=function(b){a.Helium.state.theme=b||(localStorage.getItem("theme")||"dark-theme"),localStorage.setItem("theme",a.Helium.state.theme)}}angular.module("helium").service("ThemeService",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(a,b,c,d,e){var f=!1,g=this;this.applyPrivacyLevelEvent=function(b){return"public"!==b.privacyLevel&&(b.subject=a.Helium.labels.private,"private"===b.privacyLevel&&(b.organizer=a.Helium.labels.private)),b},this.generateAvailableExtendTime=function(c,d,e){var f=[],g=0,h=a.Helium.settings.reservation.reserveNowMaxDur||120,i=new Date(c),j=new Date(new Date(c).setMinutes(c.getMinutes()+h));for(d=new Date(Math.min(d?d.getTime():1/0,j.getTime(),b.getMidnightTommorrow().getTime()));c<d;)c=new Date(c.getTime()+6e4*e),c<=d?g+=e:g=b.getTotalMinutesBetweenDates(i.getTime(),d.getTime()),f.push(g);return f},this.initValues=function(b){var c,e,f=b.events||[];for(a.Helium.values.roomId=b.roomId,a.Helium.values.roomName=b.roomName,a.Helium.values.mainRoom=a.Helium.values.mainRoom||{},a.Helium.values.mainRoom.events=a.Helium.values.mainRoom.events||[],a.Helium.values.mainRoom.events.splice(0,a.Helium.values.mainRoom.events.length),e=0;e<f.length;e++)c=f[e],c.dtStart=new Date(c.dtStart),c.dtEnd=new Date(c.dtEnd),c.instanceId=d.isString(c.instanceId)?c.instanceId:null,a.Helium.values.mainRoom.events.push(f[e]),this.applyPrivacyLevelEvent(c);return a.Helium.values},this.getCurrentEvent=function(a){var b,c,d=null,e=new Date;if(a&&a.length>0)for(b=0;b<a.length;b++)if(c=a[b],c.dtStart<=e&&e<c.dtEnd){d=c;break}return d},this.getNextEvent=function(a){var b,c,d=null,e=new Date;if(a&&a.length>0)for(b=0;b<a.length;b++)if(c=a[b],e<c.dtStart){d=c;break}return d},this.setCurrentEvent=function(c){c?a.Helium.values.mainRoom.currentEvent={id:c.id,subject:c.subject,organizer:c.organizer,dtStart:new Date(c.dtStart),dtEnd:new Date(c.dtEnd),checkedIn:c.checkedIn,state:{countdown:b.getRoundTimeLeftTill(c.dtEnd),maxExtend:0,visibleEndNow:!1,visibleExtendNow:!1,visibleCheckInNow:!1},instanceId:d.isString(c.instanceId)?c.instanceId:null,isRecurring:c.isRecurring,privacyLevel:c.privacyLevel||"public"}:(a.Helium.values.mainRoom.currentEvent=null,a.$broadcast("currentEvent",null)),a.Helium.values.mainRoom.currentEvent&&this.applyPrivacyLevelEvent(a.Helium.values.mainRoom.currentEvent),e.applyBackground()},this.setNextEvent=function(c){a.Helium.values.mainRoom.nextEvent=c?{id:c.id,subject:c.subject,organizer:c.organizer,dtStart:new Date(c.dtStart),dtEnd:new Date(c.dtEnd),checkedIn:c.checkedIn,state:{countdown:b.getRoundTimeLeftTill(c.dtStart),visibleCheckInNow:!1},isRecurring:c.isRecurring,instanceId:d.isString(c.instanceId)?c.instanceId:null,privacyLevel:c.privacyLevel||"public"}:null,a.Helium.values.mainRoom.nextEvent&&this.applyPrivacyLevelEvent(a.Helium.values.mainRoom.nextEvent)},this.refreshStateOnCurrentMeeting=function(){var c,d=a.Helium.values.mainRoom,e=d.currentEvent,f=d.nextEvent;if(e)if(c=e.state,f&&e.id===f.id)c.maxExtend=0;else if(f){var g=Math.min(90,b.getTotalMinutesBetweenDates(e.dtEnd,f.dtStart));c.maxExtend=g,c.maxExtend<1&&(c.maxExtend=0)}else c.maxExtend=90},this.createIntervalRefresh=function(){f=!0,c.subscribe(function(){var c=a.Helium.values.mainRoom,d=c.currentEvent||{},e=c.nextEvent||{};d.dtEnd&&(d.state.countdown=b.getRoundTimeLeftTill(d.dtEnd.getTime())),e.dtEnd&&(e.state.countdown=b.getRoundTimeLeftTill(e.dtStart.getTime())),g.refreshStateOnCurrentMeeting()})},this.applyRoomTimeline=function(a){this.initValues(a);var b=this.getCurrentEvent(a.events);this.setCurrentEvent(b)},this.applyRoomEvents=function(a){this.setNextEvent(a.nextEvent),this.setCurrentEvent(a.currentEvent),this.refreshStateOnCurrentMeeting(),f||this.createIntervalRefresh()},this.isReserved=function(){return null!==a.Helium.values.mainRoom.currentEvent},this.isAvailable=function(){var b=a.Helium.values.mainRoom.currentEvent,c=a.Helium.values.mainRoom.nextEvent;return null===b&&null!==c},this.isAvailableForTheRestOfTheDay=function(){var b=a.Helium.values.mainRoom.nextEvent;return null===a.Helium.values.mainRoom.currentEvent&&null===b}}angular.module("helium").service("TimelineService",a),a.$inject=["$rootScope","DatetimeFactory","AppClockService","UtilFactory","BackgroundService"]}();